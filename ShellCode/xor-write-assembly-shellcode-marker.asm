global _start

section .text
_start:
    jmp short Call_Shellcode


decoder:
    pop esi
    jmp short decode

decode:
    ; Perform xor between esi and 0xaa
    ; and then increment esi later on
    xor BYTE [esi], 0xaa
    
    ; Jump to Shellcode label when ecx is 0x0
    jz short Shellcode

    ; Increment esi here
    inc esi

    ; Else:
    jmp short decode


Call_Shellcode:
    call decoder
    Shellcode: db 0x41,0xbd,0x9b,0x6a,0x1a,0xae,0x9b,0x71,0x19,0xab,0xf3,0x9b,0x78,0x18,0xb8,0x67,0x2a,0x9b,0x6a,0x1a,0xab,0x9b,0x71,0x67,0x2a,0x42,0x4e,0x55,0x55,0x55,0xe3,0xc4,0xd9,0xc3,0xce,0xcf,0x8a,0xf9,0xc2,0xcf,0xc6,0xc6,0xc9,0xc5,0xce,0xcf,0x8b,0xa0, 0xaa
